<!DOCTYPE html>
<html xmlns="http://www.scholfin.com">
<head>
    {% load staticfiles %}
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <!--[if IE]>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <![endif]-->
    <title>ScholFin | Dashboard</title>
    <!-- BOOTSTRAP CORE STYLE  -->
    <link rel="stylesheet" href="{% static "dashboardpro/css/bootstrap.css" %}"  />
    <!-- FONT AWESOME ICONS  -->
    <link rel="stylesheet" href="{% static "dashboardpro/css/font-awesome.css"%}"  />
    <!-- CUSTOM STYLE  -->
    <link rel="stylesheet" href="{% static "dashboardpro/css/style.css"%}" />
    <script src="{% static "dashboardpro/js/jquery-1.11.1.js" %}"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular-sanitize.min.js"></script>

    <script src="{% static "provider/scripts/ng-csv.js" %}"></script>
    
    <style type="text/css">
    ul li{
        display: inline-block;
    }
    </style>
     <!-- HTML5 Shiv and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
    <header>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <strong>Email: </strong>info@scholfin.com
                    &nbsp;&nbsp;
                    <strong>Support: </strong>+91-95-037-48792
                </div>

            </div>
        </div>
    </header>
    <!-- HEADER END-->
    <div class="navbar navbar-inverse set-radius-zero">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/provider/" style="font-color:white">
                
                <h2 style="color:white; margin-left:30px">ScholFin</h2>
                    <!-- <img src="{% static "provider/images/Scholfin1.png"%}" width="200" height="100" alt="Scholfin"/> -->
                </a>

            </div>

            <div class="left-div">
                <div class="user-settings-wrapper">
                    <ul class="nav">

                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#" aria-expanded="false">
                                <span class="glyphicon glyphicon-user" style="font-size: 25px;"></span>
                            </a>
                            <div class="dropdown-menu dropdown-settings">
                                <div class="media">
                                    <!-- <a class="media-left" href="#">
                                        <img src="{% static "dashboardpro/img/64-64.jpg"%}" alt="" class="img-rounded" />
                                    </a> -->
                                    <div class="media-body">
                                        <h4 class="media-heading">{{pro.first_name}} {{pro.last_name}}</h4>
                                        <h5>{{scholarship.offered_by}}</h5>
                                    </div>
                                </div>
                                <hr />
                                <h5><strong>Email : </strong></h5>
                                {{pro.email}}
                                <hr />
                                <a href="/provider/change-password/" class="btn btn-info btn-sm">Change Password</a><a href="/provider/logout" style='margin-top:8px' class="btn btn-danger btn-sm">Logout</a>

                            </div>
                        </li>


                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- LOGO HEADER END-->
    <section class="menu-section">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="navbar-collapse collapse ">
                        <ul id="menu-top" class="nav navbar-nav navbar-right">
                            <li><a href="/provider/stats/{{url}}">Dashboard</a></li>
                            <li><a href="/provider/response/{{url}}">Response</a></li>
                            <li><a class="menu-top-active" href="/provider/shortlist/{{url}}">Shortlist</a></li>
                            <li><a href="/provider/select/{{url}}">Select</a></li>
                            <li><a href="/provider/reject/{{url}}">Reject</a></li>
                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </section>
    <!-- MENU SECTION END-->
    <div class="content-wrapper">
        <div class="container">
            <div class="row" ng-app='myapp'>
                <div class="col-md-12" ng-controller='myctrl'>
                    <h4 class="page-head-line">{{scholarship.name}} <button style='float:right' class="btn btn-default" ng-csv="getArray" csv-header = "getHeader" filename="Shortlisted.csv" field-separator="," decimal-separator="." lazy-load="true">Export Shortlist to CSV</button></h4>
                    
                </div>

            </div>

            <div class="row">
                <div class="col-md-12">
                    <div class="panel-group" id="accordion">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                    <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" class="collapsed">Applicants Profile - Select Applicants From Here</a>
                                </h4>
                            </div>
                            <div id="collapseOne" class="panel-collapse collapse" style="height: 0px;">
                                <div class="panel-body">
        {% if prof %}
           {% for applicant in prof %}
                {% if applicant.level == 'shorlisted' %}
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <ul class="row">
                            <li class="col-md-9">
                                {{applicant.user.first_name |title}} {{applicant.user.last_name |title}} ( Current Level : {{applicant.level}} )  </li>
                            <li class="col-md-3">
                                <form method="POST" action="/provider/task/">{% csrf_token %}
                                        <input type="hidden" name='applicant' value="{{applicant.user.email}}">
                                        <input type="hidden" name='scholarship' value="{{scholarship.name}}">
                                        <input type="hidden" name='url' value="{{url}}">
                                        <input type="hidden" name='action' value="select">
                                        <button type='submit' class="btn btn-success"><i class="fa fa-edit "></i> Select</button>
                                        <button type='submit' form='reject_{{forloop.counter}}' class="btn btn-danger"><i class="fa fa-pencil"></i> Reject</button>
                                </form></li>
                            <form id='reject_{{forloop.counter}}' method="POST" action="/provider/task/">{% csrf_token %}
                                        <input type="hidden" name='applicant' value="{{applicant.user.email}}">
                                        <input type="hidden" name='scholarship' value="{{scholarship.name}}">
                                        <input type="hidden" name='url' value="{{url}}">
                                        <input type="hidden" name='action' value="reject">
                                        
                                </form>                         
                            </ul>
                        </div>
                        <div class="panel-body">
                            <ul class="nav nav-tabs">
                            {% if applicant.act == 1 %}
                                <li class="active"><a href="#home_{{forloop.counter}}" data-toggle="tab">Response</a>
                                </li>
                            {% else %}
                                <li class=""><a href="#home_{{forloop.counter}}" data-toggle="tab">Response</a>
                                </li>
                            {% endif %}
                                <li class=""><a href="#profile_{{forloop.counter}}" data-toggle="tab">Profile</a>
                                </li>
                            {% if applicant.act == 2 %}
                                <li class="active"><a href="#messages_{{forloop.counter}}" data-toggle="tab">Send Email</a>
                                </li>
                            {% else %}
                                <li class=""><a href="#messages_{{forloop.counter}}" data-toggle="tab">Send Email</a>
                                </li>
                            {% endif %}
                            {% if applicant.act == 3 %}
                                <li class="active"><a href="#settings_{{forloop.counter}}" data-toggle="tab">Notes</a>
                                </li>
                            {% else %}
                                <li class=""><a href="#settings_{{forloop.counter}}" data-toggle="tab">Notes</a>
                                </li>
                            {% endif %}
                            </ul>

                            <div class="tab-content">
                            {% if applicant.act == 1 %}
                                <div class="tab-pane fade active in" id="home_{{forloop.counter}}">
                            {% else %}
                                <div class="tab-pane fade " id="home_{{forloop.counter}}">
                            {% endif %}
                            {% if applicant.act == 1 %}
                                <p class='alert alert-success'>{{applicant.status}}</p>
                            {% endif %}
                                    <h3 style='font-color:#ffffff'>Assessment</h3>
                                    <br>
                                    {% if applicant.answ %}
                                    {% for answers in applicant.answ %}
                                        <span style='font-style:italic'><strong>Q{{forloop.counter}}. {{answers.question}}</strong></span>
                                        <p>{{answers.answer | linebreaksbr}}</p>
                                    {% endfor %}
                                    {% endif %}

                                </div>
                                <div class="tab-pane fade " id="profile_{{forloop.counter}}">
                                    <h4>Educational Details</h4>
                                    <ul >
                                        <li class='col-md-6'>Educational Level : {{applicant.user_level}}</li>
                                        <li class='col-md-6'>Educational Field : {{applicant.user_field}}</li>
                                        {%if applicant.user_income %}
                                        {% if applicant.user_income != 0 %}
                                            <li class='col-md-6'>College : {{applicant.user_income}}</li>
                                        {% else %}
                                            <li class='col-md-6'></li>
                                        {% endif %}
                                        {% else %}
                                            <li class='col-md-6'></li>
                                        {% endif %}
                                        <li class='col-md-6'>Educational State : {{applicant.user_state}}</li>
                                    </ul>
                                    <h4>Personal Details</h4>
                                    <ul >
                                        <li class='col-md-6'>Email id : {{applicant.user.email}}</li>
                                        <li class='col-md-6'>Caste : {{applicant.user_caste}}</li>
                                        <li class='col-md-6'>Religion : {{applicant.user_religion}}</li>
                                        {% if applicant.user_disability == 0 %}
                                        <li class='col-md-6'>Disability : No</li>
                                        {%else%}
                                        <li class='col-md-6'>Disability : Yes</li>
                                        {% endif %}
                                    </ul>
                                    {% if applicant.docs %}
                                    <h4>Documents Required</h4>
                                    <ul>
                                        {% for doc in applicant.docs %}
                                            <li class='col-md-6'>{{doc.docs.document_name }} : 
                                            <a href="{{doc.files.url}}">{{doc.user.user.first_name}} - {{doc.docs.document_name}}</a></li>
                                        {% endfor %}
                                    {% endif %}
                                    </ul>
                                </div>
                            {% if applicant.act == 2 %}
                                <div class="tab-pane fade active in" id="messages_{{forloop.counter}}">
                            {% else %}
                                <div class="tab-pane fade " id="messages_{{forloop.counter}}">
                            {% endif %}
                            {% if applicant.act == 2 %}
                                <p class='alert alert-success'>{{applicant.status}}</p>
                            {% endif %}
                                <br>
                                    <form method="POST" action="/provider/task/">{% csrf_token %}
                                        <input type="hidden" name='applicant' value="{{applicant.user.email}}">
                                        <input type="hidden" name='scholarship' value="{{scholarship.name}}">
                                        <input type="hidden" name='url' value="{{url}}">
                                        <input type="hidden" name='action' value="mail">
                                        <input type='text' class="form-control" rows="1" placeholder=" subject" name='sub' required><br>
                                        <textarea class="form-control" rows="6" placeholder=" Write the email" name='mess' required></textarea>
                                        <br>
                                        <button type='submit' class="btn btn-warning"><span class="glyphicon glyphicon-envelope"></span> Send Email </button>&nbsp;
                                    </form>
                                </div>
                            {% if applicant.act == 3 %}
                                <div class="tab-pane fade active in" id="settings_{{forloop.counter}}">
                            {% else %}
                                <div class="tab-pane fade " id="settings_{{forloop.counter}}">
                            {% endif %}
                                    <br>
                                    <div style="diaplay:inline-block">
                                    {% if applicant.act == 3 %}
                                        <p class='alert alert-success'>{{applicant.status}}</p>
                                    {% endif %}
                                    <form method="POST" action="/provider/task/">{% csrf_token %}
                                        <input type="hidden" name='applicant' value="{{applicant.user.email}}">
                                        <input type="hidden" name='scholarship' value="{{scholarship.name}}">
                                        <input type="hidden" name='url' value="{{url}}">
                                        <input type="hidden" name='action' value="savenote">
                                        <textarea class="form-control" rows="6" placeholder="" name='notes'>{{applicant.notes}}</textarea>
                                        <br>
                                        <button type='submit' class="btn btn-info"><span class="fa fa-edit"></span> Save </button>
                                        <button type='submit' form='del_{{forloop.counter}}' class="btn btn-danger"><span class="fa fa-pencil"></span> Delete </button>
                                    </form>
                                    <form id='del_{{forloop.counter}}' method="POST" action="/provider/action/" >{% csrf_token %}
                                        <input type="hidden" name='applicant' value="{{applicant.user.email}}">
                                        <input type="hidden" name='scholarship' value="{{scholarship.name}}">
                                        <input type="hidden" name='url' value="{{url}}">
                                        <input type="hidden" name='action' value="deletenote">
                                    </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br>
            {% endif %}
                    {% endfor %}
                     {% else %}
                <div class="alert alert-warning"> No Application Have Been shortlisted </div>
                {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                    <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">Task For Next Round of Selection </a>
                                </h4>
                            </div>
                            <div id="collapseTwo" class="panel-collapse collapse" style="height: auto;">
                                <div class="panel-body">
                                <div class="alert alert-danger">
                                    NOTE : Every Shortlisted Candidate Will Receive This Mail.
                                    <br>
                                    P.S : Be Elaborateabout your task
                                </div>
                                    <form method="POST" action="/provider/task/">{% csrf_token %}
                                        <input type="hidden" name='scholarship' value="{{scholarship.name}}">
                                        <input type="hidden" name='url' value="{{url}}">
                                        <input type="hidden" name='action' value="task">
                                        <input type='text' class="form-control" rows="1" placeholder=" subject" name='sub' required><br>
                                        <textarea class="form-control" rows="12" placeholder=" Write the Task with detailed intructions" name='mess' required></textarea>
                                        <br>
                                        <button type='submit' class="btn btn-warning"><span class="glyphicon glyphicon-envelope"></span> Send Email To All</button>&nbsp;
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            
        </div>
    </div>
    <!-- CONTENT-WRAPPER SECTION END-->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    &copy; 2015 Scholfin | By : <a href="http://www.scholfin.com/" target="_blank">DesignScholFin</a>
                </div>

            </div>
        </div>
    </footer>


    <!-- FOOTER SECTION END-->
    <!-- JAVASCRIPT AT THE BOTTOM TO REDUCE THE LOADING TIME  -->
    <script type="text/javascript">

    var myapp = angular.module('myapp', ["ngSanitize", "ngCsv"]);

    myapp.controller('myctrl', function ($scope) {
        sch = window.location.pathname
        sch = sch.substr(sch.lastIndexOf('/')+1,sch.lenght)
        $.ajax({
                 type:"GET",
                 url:"/provider/download/",
                 data: {
                        'val': sch,
                        'type' : 'shortlist',
                        },
                 success: function(data){
                    data  = JSON.parse(data)
                    $scope.filename = "Shortlisted";
                    $scope.getArray = []
                    $scope.getHeader = Object.keys(data[0])
                    for (var i=0; i< data.length;i++){
                        $scope.getArray.push(data[i])
                    };
                 }
             })

    });

    </script>
    <!-- CORE JQUERY SCRIPTS -->
    <!-- BOOTSTRAP SCRIPTS  -->
    <script src="{% static "dashboardpro/js/bootstrap.js" %}"></script>
</body>
</html>